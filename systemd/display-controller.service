[Unit]
Description=Display Controller
After=network-online.target weather-dashboard.service sonify-ui.service sonos-http-api.service
Wants=network-online.target weather-dashboard.service sonify-ui.service sonos-http-api.service

[Service]
Type=simple
User=__SPAINIFY_USER__
# We keep the venv under backend, but the code under apps/display-controller
WorkingDirectory=__SPAINIFY_ROOT__
EnvironmentFile=-__SPAINIFY_ROOT__/apps/display-controller/.env
EnvironmentFile=-__SPAINIFY_ROOT__/apps/weather-dashboard/.env
EnvironmentFile=-__SPAINIFY_ROOT__/.spainify-device.env
ExecStartPre=__SPAINIFY_ROOT__/backend/venv/bin/python __SPAINIFY_ROOT__/apps/display-controller/wait_for_ready_state.py
ExecStart=__SPAINIFY_ROOT__/backend/venv/bin/python __SPAINIFY_ROOT__/apps/display-controller/display_controller.py
Environment="DISPLAY=:0"
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
